<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>شكاوى أولياء الأمور</title>
  <style>
    body{font-family: 'Cairo', sans-serif;background:linear-gradient(135deg,#0d47a1,#1976d2);color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;margin:0;padding:20px}
    .card{background:#fff;color:#222;border-radius:14px;padding:20px;max-width:480px;width:100%;box-shadow:0 10px 30px rgba(0,0,0,0.2)}
    h2{text-align:center;color:#0d47a1;margin-top:0}
    label{display:block;margin:10px 0 6px;font-weight:700;text-align:right}
    input,textarea,select,button{width:100%;padding:10px;border-radius:8px;border:1px solid #ddd;font-size:15px}
    textarea{resize:vertical}
    button{background:#0d47a1;color:#fff;border:0;margin-top:12px;cursor:pointer}
    .success{display:none;padding:14px;background:#e8f5e9;color:#2e7d32;border-radius:8px;text-align:center;margin-top:12px}
    .envelope{width:120px;height:80px;background:#fff;margin:0 auto 12px;border-radius:6px;cursor:pointer;display:block}
    .hint{font-size:13px;color:#666;text-align:center;margin-top:8px}
  </style>
</head>
<body>

  <div class="card">
    <div class="envelope" id="envelope" title="اضغط لفتح النموذج"></div>

    <div id="formWrap" style="display:none">
      <!-- ضع رابط الـ Web App في action هنا -->
      <form id="complaintForm" action="https://script.google.com/macros/s/AKfycbzg061GG5GimMAmvz4xiEkdMh0AH0uRTI4Jvx3hyw/dev" method="post" target="hidden_iframe">
        <label for="parentName">اسم ولي الأمر</label>
        <input id="parentName" name="parentName" type="text" required>

        <label for="studentName">اسم الطالب</label>
        <input id="studentName" name="studentName" type="text" required>

        <label for="grade">الصف الدراسي</label>
        <select id="grade" name="grade" required>
          <option value="">اختر...</option>
          <option>KG1</option>
          <option>KG2</option>
          <option>Primary</option>
          <option>Preparatory</option>
          <option>Secondary</option>
        </select>

        <label for="phone">رقم الهاتف</label>
        <input id="phone" name="phone" type="tel" inputmode="numeric" pattern="[0-9+ ]*" maxlength="15" placeholder="مثال: 01012345678" required>

        <label for="complaint">نص الشكوى</label>
        <textarea id="complaint" name="complaint" rows="4" required></textarea>

        <button id="submitBtn" type="submit">إرسال الشكوى</button>
      </form>
      <div class="hint">ستُرسل الشكوى آمنًا إلى إدارة المدرسة.</div>
    </div>

    <div class="success" id="successMsg">
      <h3>✔️ تم إرسال الشكوى بنجاح</h3>
      <p>شكراً لتواصلك — سنقوم بالرد في أقرب وقت.</p>
    </div>
  </div>

  <!-- iframe مخفي لاستقبال رد السيرفر بدون إعادة تحميل الصفحة -->
  <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

  <script>
    const envelope = document.getElementById('envelope');
    const formWrap = document.getElementById('formWrap');
    const form = document.getElementById('complaintForm');
    const successMsg = document.getElementById('successMsg');
    const submitBtn = document.getElementById('submitBtn');
    const iframe = document.getElementById('hidden_iframe');

    envelope.addEventListener('click', ()=> {
      envelope.style.display = 'none';
      formWrap.style.display = 'block';
    });

    form.addEventListener('submit', ()=> {
      // Disable زر وإظهار نص انتظار بسيط
      submitBtn.disabled = true;
      submitBtn.textContent = 'جاري الإرسال...';
    });

    // عندما يُحمّل الـ iframe (يعني السيرفر ردّ) نعرض رسالة النجاح
    iframe.addEventListener('load', ()=> {
      // قد يتكرر onload عند التحميل الأول (قبل إرسال). نتأكد أن زر الإرسال كان معطلًا.
      if (!submitBtn.disabled) return;
      formWrap.style.display = 'none';
      successMsg.style.display = 'block';
      submitBtn.disabled = false;
      submitBtn.textContent = 'إرسال الشكوى';
      form.reset();
    });
  </script>
</body>
</html>
